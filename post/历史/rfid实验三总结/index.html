
<!DOCTYPE html>
<html
  lang="zh"
  data-figures=""
  
    class="page"
  
  
  >
  <head>
<title>RFID实验三总结 | Clarity</title>
<meta charset="utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">





  
<meta property="og:locale" content="zh" />

<meta property="og:type" content="article">
<meta name="description" content="
一次debug到哭泣的经历。
龙云尧个人博客，转载请注明出处。
CSDN地址：
个人blog地址：http://123.207.243.115:81/rfidshi-yan-san-zong-jie/
在实验过程中，需要不断翻阅实验课PPT之**《04 电子钱包的功能》，word之《实验3文档》**，以及不知名大佬的 …" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="@janedoe">
<meta name="twitter:title" content="RFID实验三总结" />
<meta name="twitter:image" content="https://yaoyl.cn/images/thumbnail.png"/>
<meta property="og:url" content="https://yaoyl.cn//post/%E5%8E%86%E5%8F%B2/rfid%E5%AE%9E%E9%AA%8C%E4%B8%89%E6%80%BB%E7%BB%93/" />
<meta property="og:title" content="RFID实验三总结" />
<meta property="og:description" content="
一次debug到哭泣的经历。
龙云尧个人博客，转载请注明出处。
CSDN地址：
个人blog地址：http://123.207.243.115:81/rfidshi-yan-san-zong-jie/
在实验过程中，需要不断翻阅实验课PPT之**《04 电子钱包的功能》，word之《实验3文档》**，以及不知名大佬的 …" />
<meta property="og:image" content="https://yaoyl.cn/images/thumbnail.png" />
  <meta name="keywords" content="RFID,java" />
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "BlogPosting",
      "mainEntityOfPage":"https:\/\/yaoyl.cn\/\/post\/%E5%8E%86%E5%8F%B2\/rfid%E5%AE%9E%E9%AA%8C%E4%B8%89%E6%80%BB%E7%BB%93\/",
      "name": "Clarity",
      "headline": "RFID实验三总结",
      "description": "\u003cblockquote\u003e\n\u003cp\u003e一次debug到哭泣的经历。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003e龙云尧个人博客，转载请注明出处。\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eCSDN地址：\u003c/p\u003e\n\u003cp\u003e个人blog地址：http://123.207.243.115:81/rfidshi-yan-san-zong-jie/\u003c/p\u003e\n\u003cp\u003e在实验过程中，需要不断翻阅实验课PPT之**《04 电子钱包的功能》\u003cstrong\u003e，word之\u003c/strong\u003e《实验3文档》**，以及不知名大佬的\u003ca href=\"http://www.tqcto.com/article/software/83894.html\"\u003e …\u003c/a\u003e\u003c/p\u003e",
      "url": "https:\/\/yaoyl.cn\/\/post\/%E5%8E%86%E5%8F%B2\/rfid%E5%AE%9E%E9%AA%8C%E4%B8%89%E6%80%BB%E7%BB%93\/",
      "datePublished": "2017-05-23T01:19:42Z",
      "dateModified": "2017-05-23T01:19:42Z",
      "keywords": ["RFID","java"],
        "articleSection": ["Java"],
      "author": {
        "@type": "Person",
        "name": "map[name:Yunyao Long]"
      },
      "image":{
        "@type":"ImageObject",
        "url": "https:\/\/yaoyl.cn\/images\/thumbnail.png"
      },
      "publisher": {
        "@type": "Organization",
        "logo": {
          "@type":"ImageObject",
          "url": "https:\/\/yaoyl.cn\/logos\/logo.png"
        },
        "name": "Clarity"
      }
    }
  </script>

<link rel="apple-touch-icon" sizes="180x180" href="https://yaoyl.cn/icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://yaoyl.cn/icons/favicon-32x32.png">
<link rel="manifest" href="https://yaoyl.cn/icons/site.webmanifest">

<link rel="canonical" href="https://yaoyl.cn//post/%E5%8E%86%E5%8F%B2/rfid%E5%AE%9E%E9%AA%8C%E4%B8%89%E6%80%BB%E7%BB%93/">



<link rel="preload" href="https://yaoyl.cn//css/styles.dc38388a8f0b890e788bd3a99b7495d14e7d5ac4359ed3b49abeb778497863b284ad4cc7e496ef58c84139295f9bafed82f5a41345eda86bd2d429cccb7c2596.css" integrity = "sha512-3Dg4io8LiQ54i9Opm3SV0U59WsQ1ntO0mr63eEl4Y7KErUzH5JbvWMhBOSlfm6/tgvWkE0XtqGvS1CnMy3wllg==" as="style" crossorigin="anonymous">



<link rel="preload" href="https://yaoyl.cn//zh/js/bundle.8f271a7a6d395b2060587165126e81bf1265bf8be2a25f4da029201983fd6a1ce76d15acb6cec02a048c2818f979766a191371aff44d01905ff33ee0875706d0.js" as="script" integrity=
"sha512-jycaem05WyBgWHFlEm6BvxJlv4viol9NoCkgGYP9ahznbRWsts7AKgSMKBj5eXZqGRNxr/RNAZBf8z7gh1cG0A==" crossorigin="anonymous">


<link rel="stylesheet" type="text/css" href="https://yaoyl.cn//css/styles.dc38388a8f0b890e788bd3a99b7495d14e7d5ac4359ed3b49abeb778497863b284ad4cc7e496ef58c84139295f9bafed82f5a41345eda86bd2d429cccb7c2596.css" integrity="sha512-3Dg4io8LiQ54i9Opm3SV0U59WsQ1ntO0mr63eEl4Y7KErUzH5JbvWMhBOSlfm6/tgvWkE0XtqGvS1CnMy3wllg==" crossorigin="anonymous">

  </head>
  <body
    data-code="7"
    data-lines="false"
    id="documentTop"
    data-lang="zh"
  >

<header class="nav_header" >
  <nav class="nav"><a href='https://yaoyl.cn/' class="nav_brand nav_item" title="Clarity">
  <img src="https://yaoyl.cn/logos/logo.png" class="logo" alt="Clarity">
  <div class="nav_close">
    <div><svg class="icon">
  <title>open-menu</title>
  <use xlink:href="#open-menu"></use>
</svg>
<svg class="icon">
  <title>closeme</title>
  <use xlink:href="#closeme"></use>
</svg>
</div>
  </div>
</a>

    <div class='nav_body nav_body_left'>
      
      
      
        

  <div class="nav_parent">
    <a href="https://yaoyl.cn/" class="nav_item" title="主页">主页 </a>
  </div>
  <div class="nav_parent">
    <a href="https://yaoyl.cn/post/rich-content/" class="nav_item" title="加精">加精 </a>
  </div>
  <div class="nav_parent">
    <a href="https://yaoyl.cn/" class="nav_item" title="外链">外链 <img src='https://yaoyl.cn/icons/caret-icon.svg' alt="icon" class="nav_icon"></a>
    <div class="nav_sub">
      <span class="nav_child"></span>
        <a href="https://www.linkedin.com/" class="nav_child nav_item" title="LinkedIn">LinkedIn</a>
    </div>
  </div>
  <div class="nav_parent">
    <a href="https://yaoyl.cn/about/" class="nav_item" title="关于我">关于我 </a>
  </div>
      
      <div class="nav_parent">
        <a href="#" class="nav_item"></a>
        <div class="nav_sub">
          <span class="nav_child"></span>
          
          <a href="https://yaoyl.cn//en/" class="nav_child nav_item">English</a>
          
          <a href="https://yaoyl.cn//pt/" class="nav_child nav_item">Português</a>
          
          <a href="https://yaoyl.cn//" class="nav_child nav_item">中文</a>
          
        </div>
      </div>
<div class='follow'>
  <a href="https://github.com/YunyaoLong">
    <svg class="icon">
  <title>github</title>
  <use xlink:href="#github"></use>
</svg>

  </a>
  <a href="https://www.linkedin.com/in/yunyaolong/">
    <svg class="icon">
  <title>linkedin</title>
  <use xlink:href="#linkedin"></use>
</svg>

  </a>
<div class="color_mode">
  <input type="checkbox" class="color_choice" id="mode">
</div>

</div>

    </div>
  </nav>
</header>

    <main>
  
<div class="grid-inverse wrap content">
  <article class="post_content">
    <h1 class="post_title">RFID实验三总结</h1>
  <div class="post_meta">
    <span><svg class="icon">
  <title>calendar</title>
  <use xlink:href="#calendar"></use>
</svg>
</span>
    <span class="post_date">
      May 23, 2017	  
    </span>
    <span class="post_time"> · 1 分钟阅读</span><span>&nbsp;· <a href='https://yaoyl.cn/tags/rfid/' title="RFID" class="post_tag button button_translucent">RFID
        </a><a href='https://yaoyl.cn/tags/java/' title="java" class="post_tag button button_translucent">java
        </a>
    </span>
    <span class="page_only">&nbsp;·
  <div class="post_share">
    分享到:
    <a href="https://twitter.com/intent/tweet?text=RFID%e5%ae%9e%e9%aa%8c%e4%b8%89%e6%80%bb%e7%bb%93&url=https%3a%2f%2fyaoyl.cn%2f%2fpost%2f%25E5%258E%2586%25E5%258F%25B2%2frfid%25E5%25AE%259E%25E9%25AA%258C%25E4%25B8%2589%25E6%2580%25BB%25E7%25BB%2593%2f&tw_p=tweetbutton" class="twitter" title="分享到 Twitter" target="_blank" rel="nofollow">
      <svg class="icon">
  <title>twitter</title>
  <use xlink:href="#twitter"></use>
</svg>

    </a>
    <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fyaoyl.cn%2f%2fpost%2f%25E5%258E%2586%25E5%258F%25B2%2frfid%25E5%25AE%259E%25E9%25AA%258C%25E4%25B8%2589%25E6%2580%25BB%25E7%25BB%2593%2f&t=RFID%e5%ae%9e%e9%aa%8c%e4%b8%89%e6%80%bb%e7%bb%93" class="facebook" title="分享到 Facebook" target="_blank" rel="nofollow">
      <svg class="icon">
  <title>facebook</title>
  <use xlink:href="#facebook"></use>
</svg>

    </a>
    <a href="#linkedinshare" id = "linkedinshare" class="linkedin" title="分享到 LinkedIn" rel="nofollow">
      <svg class="icon">
  <title>linkedin</title>
  <use xlink:href="#linkedin"></use>
</svg>

    </a>
    <a href="https://yaoyl.cn//post/%E5%8E%86%E5%8F%B2/rfid%E5%AE%9E%E9%AA%8C%E4%B8%89%E6%80%BB%E7%BB%93/" title="Copy Link" class="link link_yank">
      <svg class="icon">
  <title>copy</title>
  <use xlink:href="#copy"></use>
</svg>

    </a>
  </div>
  </span>
  </div>

    <div class="post_body"><blockquote>
<p>一次debug到哭泣的经历。</p></blockquote>
<p><strong>龙云尧个人博客，转载请注明出处。</strong></p>
<p>CSDN地址：</p>
<p>个人blog地址：http://123.207.243.115:81/rfidshi-yan-san-zong-jie/</p>
<p>在实验过程中，需要不断翻阅实验课PPT之**《04 电子钱包的功能》<strong>，word之</strong>《实验3文档》**，以及不知名大佬的<a href="http://www.tqcto.com/article/software/83894.html">课程总代码</a>，CSDN大佬吕浪的<a href="http://blog.csdn.net/lv_victor/article/details/51028930">Java card开发系列文章</a>。</p>
<p>本次实验和前两次实验相比，代码量多<strong>很多</strong>，并且<strong>实验思路稍有区别</strong>。实验之前可以不太懂实验流程（主要是因为流程本身就太复杂了），但是一定要<strong>一遍又一遍阅读源代码</strong>，只有在读源码的过程中，才能体会整个验证过程，对项目中涉及到的函数方法的使用才能有一个更加深入的了解。接着自己不断重写代码，理解整个实现过程，才能对这个课程实验有较为深入的了解。</p>
<p>最终的代码地址：https://github.com/LongyunYao/RFID_lab/</p>
<p><strong>代码在未征得本人同意之前，请勿直接Ctrl+C，Ctrl+V，谢谢。</strong></p>
<h1 id="正式实验">正式实验</h1>
<h2 id="实验分析">实验分析</h2>
<p>首先我们在PPT中知道本次实验的主要需要实现的功能是：</p>
<ul>
<li>圈存</li>
<li>消费</li>
<li>余额查询</li>
</ul>
<p>接下来我们开始看ppt《04 电子钱包的功能》和《实验3文档》。</p>
<p>首先是圈存功能的流程图。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="圈存流程"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423014034933?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>流程图中我们可以分析出圈存一共有4个步骤：</p>
<ul>
<li><strong>终端发送消息初始化</strong></li>
<li><strong>IC响应初始化，并且发送MAC1验证</strong></li>
<li><strong>终端验证MAC1，确认IC卡是否合法，然后发送包含MAC2的圈存命令</strong></li>
<li><strong>IC卡验证终端机的合法性，执行完成以后返回TAC响应操作完成</strong></li>
</ul>
<p>接下来我们将一步一步仔细分析圈存是如何实现的。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="圈存初始化命令"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423013823877?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>step1：圈存机发送的初始信息如下所示。消息中包含了<strong>秘钥标识符</strong>，<strong>交易金额</strong>，<strong>终端机编号</strong>。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="IC卡响应圈存初始化命令"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423014006004?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="IC卡处理圈存初始化信息流程"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423020343856?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>step2：</p>
<ul>
<li><strong>IC卡根据秘钥标识符寻找圈存秘钥</strong></li>
<li><strong>生成过程秘钥。输入数据为[伪随机数||电子钱包联机交易序号||8000]，秘钥为圈存秘钥，使用3DES加密算法。</strong></li>
<li><strong>生成MAC1。输入数据为[电子钱包余额（交易前）||交易金额||交易类型标识||终端机编号]，秘钥为过程秘钥，使用我们在上一次实现的MAC生成函数gmac4，计算出MAC1用来表明身份。</strong></li>
<li><strong>IC卡返回[余额||联机交易序列号||秘钥版本号||算法标识||伪随机数||MAC1]。</strong></li>
</ul>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="圈存指令"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423014058551?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="圈存指令流程"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423025731193?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>step3：</p>
<ul>
<li><strong>圈存机对IC卡发挥的MAC1信息进行校验，如果正确就说明IC卡信息合法。</strong></li>
<li><strong>计算MAC2。输入信息为[交易金额||交易类型标识||终端机编号||交易日期（主机）||交易时间（主机）]，秘钥为过程秘钥，加密算法为依然为gmac4。用来表明自己的身份。</strong></li>
<li><strong>发送圈存指令。消息中包含[交易日期||交易时间||MAC2]。</strong></li>
</ul>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="圈存TAC"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423030729769?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="TAC"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423124717634?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>step4：<strong>IC使用同样的算法计算MAC2，如果计算结果和终端返回的MAC2一致，就说明终端的身份合法。IC卡就会执行圈存命令。同时返回TAC。其中TAC计算时，输入数据为[电子钱包余额（交易后）||电子钱包联机交易序号（加１前）||交易金额||交易类型标识||终端机编号||交易日期（主机）||交易时间（主机）]，密钥为TAC密码最左8个字节与TAC密码最右8个字节异或的结果。</strong></p>
<p>到这里整个圈存过程就结束了。消费以及查询和圈存的实现原理一致，这里就不赘述了。</p>
<h2 id="读代码">读代码</h2>
<p>前面的分析中，我们已经对本次实验有了大致的了解，接下来就是开始<strong>读源码</strong>的过程了。不过本次实验中，因为我们只需要对IC卡的系统进行编程实现，而对终端机需要靠人脑完成，所以我们重心就会放在圈存的初始化和圈存的执行上面了。</p>
<h3 id="圈存初始化">圈存初始化</h3>
<p>还是老样子，我们<strong>先读项目给的源码中的<code>Purse</code>部分</strong>，里面有圈存初始化和圈存确认信息的处理函数。</p>
<p>在TA给的源代码中，<code>init_load</code>和<code>load</code>方法是已经给好了的，我们先读这两部分的源代码，理解整个设计思路。</p>
<p>首先我们需要<strong>修改Purse类</strong>，让其<code>process</code>方法里面增执行<strong>圈存初始化，圈存，消费初始化，消费，以及查询的入口</strong>。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="handleEvent"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423105626634?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>因为圈存和消费的init方法的ins都一样，所以我们还需要<strong>增加一个判断方法，利用两者p1参数不一样，来判断是<code>init_load</code>还是<code>init _purchase</code>。</strong></p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="init_load_purchase"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423105924050?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>好了，入口写好了。我们开始看<code>init_load</code>的实现方法。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="init_load"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423110115765?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>前面还是和读写数据时一样的操作，进行参数校对，这个部分已经很简单了。我们看到有一个<code>findkey</code>方法。点进去查看函数的具体内容。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="find_key"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423110323737?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>查找方法比较简单，从Key数组中获取秘钥，存进pbuf中，如果存在就返回秘钥标识符，否则返回0。</p>
<p>回到<code>init_load</code>，在执行<code>fendkey</code>之后，是异常处理，验证是否查找失败。然后执行<code>init4load</code>方法。继续点进去查看。（<strong>前方高能预警</strong>）</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="init4load"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423110857476?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>回忆一下初始化的过程中，IC的操作部分是怎么操作的。</p>
<ul>
<li><strong>IC卡根据秘钥标识符寻找圈存秘钥</strong></li>
<li><strong>生成过程秘钥。输入数据为[伪随机数||电子钱包联机交易序号||8000]，秘钥为圈存秘钥，使用3DES加密算法。</strong></li>
<li><strong>生成MAC1。输入数据为[电子钱包余额（交易前）||交易金额||交易类型标识||终端机编号]，秘钥为过程秘钥，使用我们在上一次实现的MAC生成函数gmac4，计算出MAC1用来表明身份。</strong></li>
<li><strong>IC卡返回[余额||联机交易序列号||秘钥版本号||算法标识||伪随机数||MAC1]。</strong></li>
</ul>
<p>按照这个思路看源代码。（看代码的时候<strong>一定要对着ppt的流程读</strong>，我第一次读源代码就是单纯对着IDE读，结果读的很爽，但是读完了只知道每个基本操作在干嘛，但是整个操作流程还是一脸懵逼。）</p>
<p>开始看代码。</p>
<p>首先从<code>data</code>中提取交易金额，终端编号，存进<code>pTemp42</code>和<code>pTemp81</code>。</p>
<p>然后判断是否超额。我们继续点进去看一下<code>increase</code>的源代码。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="increase"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423112034624?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>从<code>EP_ balance</code>中和<code>data</code>中依次取出一个字节，将其相加再和一个<code>ads</code>(进位标志符)相加，如果<code>flag</code>为真，就改写<code>EP _balance</code>中的值，然后更新<code>ads</code>。最终返回进位标志位<code>ads</code>。整个就是大数加法的思想方法。但是<code>EP _balance</code>是啥？？？我们再点进去看源代码。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="EPFile参数"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423112922909?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>是当前电子钱包的余额。因此<strong>整个<code>increase</code>就是判断当前余额加上一个圈存值，如果超额（结果超过4bytes），就会返回1（那个进位标志位<code>ads</code>）。否则返回0。如果传入的第二个参数为false，就不会更新余额，否则会执行余额更新操</strong>作。</p>
<p>好，到这里我们知道了<code>rc = increase(pTemp42, false);</code>部分的意义了。再往下看密码取位部分。</p>
<p>首先使用<code>readkey</code>方法。点进去查看。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="readkey"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423113526567?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>这里需要对<code>Key</code>的结构有一定的了解了。我们点进去查看<code>Key</code>这个类定义和实现。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="Key"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423113915210?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p><strong>所以<code>Key</code>中存放的结构</strong>为<strong>2bytes信息位</strong>（分别为1byte的<code>pbuf</code>，1byte的<code>length</code>），<strong>5bytes的秘钥头</strong>，<strong>以及16bytes的秘钥值</strong>。其中<strong>length是addKey传入value的长度，为表头+秘钥的长度。</strong></p>
<p>回到<code>readkey</code>，<code>readkey</code>就是将秘钥取出来，然后将秘钥表头中的<code>value</code>值取出来（5bytes表头+16bytes秘钥），<strong>返回长度为秘钥的实际长度（减掉了表头长度）</strong>。</p>
<p>回到init4load，所以这4行代码的意义就是</p>
<ul>
<li><strong>按照秘钥获取部分就是按照秘钥标识符获取bytes秘钥头+16bytes秘钥存进pTemp32</strong></li>
<li><strong>从秘钥头第4个bytes获取秘钥版本号，从第5个bytes获取算法标识符</strong></li>
<li><strong>从获取pTemp32中将秘钥的实际值（从第5位开始读取秘钥长度个bytes），取出来存进pTemp16。</strong></li>
</ul>
<p>再往下读随机数产生的代码。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="GenerateSecureRnd"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423115943237?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>调用<code>rd.generateData</code>方法，对传入的参数进行操作。我们在查看generateData的实现方法的时候，已经进入.class文件，没有发现有意义的信息。于是折返查看<strong>v和size的信息</strong>。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="v的意义"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423120253285?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>根据注释，我们可以大概知道<code>GenerateSecureRnd</code>的意义就是<strong>根据特定的随机数产生机制产生随机数，然后写进v</strong>。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="getRndValue"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423120545489?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p><code>getRndValue</code>方法就是<strong>将随机数v写入参数bf中，偏移位为bOff</strong>。</p>
<p>回到<code>init4load</code>，产生随机数这两行的意义就是<strong>产生随机数</strong>，然后将随机数写进<code>pTemp32</code>的[0:3]位。</p>
<p>接下来，将<code>EP_online</code>(电子钱包脱机交易序号，之前分析图片中出现过)写入<code>pTemp32[4:5]</code>，将<code>0x8000</code>写入<code>pTemp32[6:7]</code>，调用上一次实验中实现的<code>3des</code>加密算法，秘钥为上面得到的圈存秘钥（存在<code>pTemp16</code>中）<strong>产生过程秘钥</strong>，写入<code>pTemp82</code>。</p>
<p>回看前面分析的圈存初始化的第一步和第二步，**①IC卡根据秘钥标识符寻找圈存秘钥；②生成过程秘钥。输入数据为[伪随机数||电子钱包联机交易序号||8000]，秘钥为圈存秘钥，使用3DES加密算法。**是不是一模一样？</p>
<p>好，我们再往下看。</p>
<p>产生<code>MAC1</code>。首先分别往<code>pTemp32</code>中写入<code>EP_balance</code>（余额），<code>data[1:4]</code>（交易金融，对着那一页PPT找<code>data</code>结构就知道了），0x02，<code>data[5:10]（</code>终端机编号，一样看ppt中的<code>data</code>结构），然后将<code>pTemp32</code>中的内容复制到<code>data</code>（不知道这里写入data有什么意义，因为在响应数据部分又会被写一次。）。然后<strong>使用上次实验实现的<code>gmac4</code>，输入数据为<code>pTemp32</code>，秘钥为上一步得到的存在<code>pTemp82</code>的过程秘钥，得到的<code>mac1</code>存在<code>pTemp41</code>中</strong>。</p>
<p>同样回看前面分析的圈存初始化的第三步。<strong>生成MAC1。输入数据为[电子钱包余额（交易前）||交易金额||交易类型标识||终端机编号]，秘钥为过程秘钥，使用我们在上一次实现的MAC生成函数gmac4，计算出MAC1用来表明身份</strong>。是不是对上了？</p>
<p>然后将**<code>EP_balance</code>（余额），<code>EP _online</code>(电子钱包脱机交易序号），<code>keyID</code>（秘钥版本号），<code>algID</code>（算法标识符），随机数，以及mac1写进data**。</p>
<p>回看圈存初始化的第四步，<strong>IC卡返回[余额||联机交易序列号||秘钥版本号||算法标识||伪随机数||MAC1]</strong>。一模一样。</p>
<p>到这里<code>init4load</code>也结束了，往上回到<code>init_load</code>，<code>papdu.pdata</code>已经在<code>init4load</code>中设置完成，在<code>papdu.le</code>（理想的下一次指令中的数据长度）写为<code>0x10</code>。然后<code>purse.init _load</code>结束。</p>
<p>光分析这一步我写了一个半钟，当时在读源代码的时候花的时间更久。<strong>但是这个步骤不能跳过，它让我们对整个IC卡的业务逻辑和方法实现以及调用打下了基础。我们在实现其他方法的时候，才能更加得心应手。</strong></p>
<p>再看<code>purse.load</code>方法吧。这一步实现了<strong>圈存</strong>。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="purse.load"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423123727349?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>前面的就不详说了，它调用了<code>EPfile.load</code>方法，我们点进去查看。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="load实现"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423123641864?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>回想在一开始分析的时候，<strong>step4中，IC卡对接收到的终端机指令是怎么处理的</strong>。</p>
<p><strong>step4：IC使用同样的算法计算MAC2，如果计算结果和终端返回的MAC2一致，就说明终端的身份合法。IC卡就会执行圈存命令。同时返回TAC。</strong></p>
<p><strong>查看MAC2的产生方法：输入信息为[交易金额||交易类型标识||终端机编号||交易日期（主机）||交易时间（主机）]，秘钥为过程秘钥，加密算法为为gmac4。</strong></p>
<p><strong>查看TAC的产生方法：输入数据为[电子钱包余额（交易后）||电子钱包联机交易序号（加１前）||交易金额||交易类型标识||终端机编号||交易日期（主机）||交易时间（主机）]，密钥为TAC密码最左8个字节与TAC密码最右8个字节异或的结果。</strong></p>
<p>通过源代码和步骤分析我们可以得出，<code>EPFile.load</code>整个过程就是将step4实现的过程，不过需要注意的是，<strong><code>EPFile.load</code>中不少参数使用的是<code>EPFile.init4load</code>中存下来放在<code>pTemp</code>中的值，这也就从逻辑上说明为什么我们在执行消费命令前必须执行消费初始化命令，保证了安全性</strong>。返回<code>purse.load</code>，校验异常，设置<code>papdu.le</code>，<code>purse.load</code>也就结束了。</p>
<p><strong>整个阅读过程需要不断跳转代码，也需要不断在代码和PPT《04 电子钱包的功能》和word《实验3文档》。同时因为pTemp实在太多，我们最好能够在一旁做笔记，记录下来每一个pTemp存放了哪些值，以及它们的作用，这样我们才能在实现消费和查询的时候，使用起来更加方便。</strong></p>
<p>附上我记录的在init4load和load中各种变量的变化情况以及pTemp们的存在意义。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="load中pTemp的意义"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423130443504?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p><strong>大部分pTemp其实是有固定意义的</strong>（结合PPT中传入的各种数据长度，我们就不难理解为什么了）。<strong>pTemp32一般作为中间变量，用来进行3des加密或者gmac加密。</strong></p>
<p>谨记这一点，结合我们在上一步中总结下来的经验。我们就可以着手实现init_purchase和purchase以及get _balance了。</p>
<p>查看消费的流程图。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="消费流程"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423014144435?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>我们可以总结出消费的如下流程</p>
<ul>
<li><strong>终端发送消息初始化</strong></li>
<li><strong>IC响应初始化，发回随机数</strong></li>
<li><strong>终端产生MAC1，证明自己的身份，将交易信息发给IC卡</strong></li>
<li><strong>IC卡验证终端机的合法性，计算MAC2和TAC，返回给终端作为身份凭证和消费凭证</strong></li>
</ul>
<p>然后一步一步详细分析。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="消费初始化命令"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423014121833?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>step1：圈存机发送的初始信息如下所示。消息中包含了<strong>密钥标识符</strong>，<strong>交易金额</strong>，<strong>终端机编号</strong>。（整个消息串中，除了p1、le对比圈存初始化指令有区别以外，并没有其他区别）。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="IC卡处理消费初始化信息"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423013855815?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="IC卡处理消费初始化指令流程"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423141716336?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>step2：</p>
<ul>
<li><strong>IC卡根据秘钥标识符寻找圈存秘钥</strong></li>
<li><strong>生成随机数</strong></li>
<li><strong>检查余额是否足够支付本次交易</strong></li>
<li><strong>返回[余额||脱机交易序号||透支限额||秘钥版本号||算法标识||伪随机数]</strong></li>
</ul>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="消费指令"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423014207170?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>step3: <strong>终端将命令响应数据传送给主机，主机利用消费主密钥产生消费子密钥，并生成MAC1。然后终端向IC发送[交易序列号||交易日期||交易时间||MAC1]。（和圈存中发送的信息中多了一个交易序列号）。</strong></p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="IC卡处理消费"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423144717148?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="IC卡处理消费流程"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423144743555?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>step4：</p>
<ul>
<li><strong>IC卡根据消费秘钥生成过程秘钥</strong></li>
<li><strong>利用过程秘钥生成MAC1</strong></li>
<li><strong>交易序列号+1，将消费金额从卡中扣除。</strong></li>
<li><strong>IC卡生成MAC2（证明自己身份），和TAC（证明工作完成）。</strong></li>
<li><strong>返回TAC和MAC2给终端</strong></li>
</ul>
<p><strong>首先我们填<code>purse</code>中的<code>init_purchase</code>函数。</strong>（这一步可以先从<code>init _load</code>中复制下来，然后稍微修改一下<code>p1</code>和<code>le</code>的值，以及调用的函数改成<code>init4purchase</code>，原因我刚刚在<code>step1</code>中说过了）。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="init_purchase"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423145736310?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p><strong>接着我们需要实现<code>EPFile.init4purchase</code></strong>。同样的，我们只需要按照step2步骤，从<code>init4load</code>中，按需复制代码就行。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="EPFile_init4purchase"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423150940801?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p><strong>同时我们需要对照并且记录下来，每一个pTemp使用是否正确，还要记录init4purchase中每一步执行完成以后pTemp中数据对应的值。</strong></p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="EPFile_init4purchase_参数"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423151241922?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>**然后我们再实现<code>EPFile.purchase</code>方法。**实现过程比较复杂，但是每执行一步，就更新所有参数的状态，<strong>按照我们之前整理出来的<code>pTemp</code>用法，使用复制粘贴大法，从<code>EPFile.init4load</code>和<code>EPFile.load</code>中可以提取大量的重复代码下来。</strong></p>
<p>需要注意的是，<code>load</code>中是余额加上交易金额，<code>purchase</code>中就应该是减去交易金额。因此<strong>我们必须手动实现<code>decrease</code>方法。</strong></p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="decrease"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423152007887?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>实现方法和<code>increase</code>类似，从后向前，一次取1byte，进行减法，同时更新借位，最后返回借位即可。</p>
<p>这里有一个小插曲，在计算MAC2的时候，一般不会出什么问题，但是在计算TAC的时候，就会出问题，这个坑在我最后debug的时候才发现（为了找这个bug整整debug了一个多钟= =）。于是我重新改变策略，使用在MAC2生成并且存进data中以后，将pTemp32新开一个数组（JCSystem.makeTransientByteArray），然后重新作为中间变量进行操作，但是不知道为什么，这样操作的结果还是错误的。于是就按照网上流传的代码，在计算TAC的时候，新申明了一个temp数组用来作为临时变量。</p>
<p>最终实现的代码如图。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="EPFile_purchase_part1"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423152859418?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>

<figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="EPFile_purchase_part2"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423152925637?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>参数变化的记录如图。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="EPFile_purchase_参数"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423153748861?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>最后一个就是<code>get_balance</code>了。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="余额查询指令"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423014320552?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>直接从<code>EP_balance</code>里面读出来就行了，一行代码搞定。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="EPFile_get_balance"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423153423563?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p><strong>到这里，整个实验中需要我们填写的功能函数全部填写完成了。试验过程中，了解业务逻辑是一个很重要的过程，阅读源码，了解源码中每一个函数的具体意义，以及每一个参数中，存放的信息有哪些，这些都最好都在一个txt或者什么地方器记录下来，方便自己查阅和提取（毕竟一个没有debug的IDE，你不能要求什么，只能人脑debug），另一方面，每实现一个功能，就尽可能写清楚这个部分的功能，同时写清楚那些信息在哪些位置，这样你在实现的过程中才不会头晕脑胀。也能够方便你最后debug找错误信息从哪来。</strong></p>
<h1 id="验证实验">验证实验</h1>
<p>验证之前，我们还需要添加新的参数信息。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="condef新添加"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423154411458?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p><strong>以及一个的天坑的地方</strong>。。。。。。。这个地方我用throw 0x1234大法，从init_purchase的return 0之前，一直回退到Purse中的if(papdu.APDUContainData())才找到问题。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="Papdu新增"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423154457374?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>其他的地方应该没什么需要添加或者修改了，按照之前上一次的试验方法，我们可以开始进行debug了。</p>
<p>首先还是新建一个txt，因为我们需要人脑担任终端机的角色，所以<strong>提前将必要的操作流程和模板写下来存在txt里面</strong>，写指令的时候也能迅速一点。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="实验3脚本"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423155806313?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>首先实验一中的初始化脚本。</p>
<p>然后模仿终端机输入圈存初始化指令。<code>/send 805000020B080000100000112233445510</code></p>
<p>使用**[伪随机数||电子钱包联机交易序号||8000]<strong>作为数据，<strong>圈存秘钥</strong>作为秘钥，使用</strong>3DES<strong>获得</strong>过程秘钥**。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="init4load过程秘钥"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423160609340?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>然后<strong>使用过程秘药作为秘钥</strong>，输入自定义好的初始向量，以及数据**[电子钱包余额（交易前）||交易金额||交易类型标识(0x02)||终端机编号]<strong>作为输入，生成</strong>mac1**，和<strong>IC卡返回的mac1校对，发现一致</strong>。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="验证mac1"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423161353741?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>接着使用**[电子钱包余额（交易前）||交易金额||交易类型标识(0x02)||终端机编号]**作为数据，<strong>过程秘钥</strong>作为秘钥，生成mac2。夹杂其他信息一起发出去。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="init_load发送mac2"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423162142821?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>返回<code>TAC+9000</code>，所以我们认为<code>init_load</code>和<code>load</code>成功。</p>
<p>接下来执行查询指令，返回<code>00 00 10 00 90 00</code>。说明卡里面已经有了<code>00001000</code>，我们圈存确实成功了。查询也成功了。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="查询结果"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423162321041?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>接下来执行消费指令，<code>/send 805001020B07000010000011223344550F</code></p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="消费初始化"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423162639620?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>返回得到伪随机数。接着我们将**[伪随机数||电子钱包脱机交易序号||终端交易序号的最右两个字节]<strong>作为数据，<strong>消费秘钥</strong>作为秘钥，使用</strong>3DES<strong>得到</strong>圈存秘钥**。</p>
<p>使用**[交易金额||交易类型标识(0x06)||终端机编号||交易日期（主机）||交易时间（主机）]<strong>作为数据，<strong>过程秘钥</strong>最为秘钥生成</strong>mac1**。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="消费发送mac1"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423163133686?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>返回<code>MAC2+TAC+9000</code>。故而我们认为本次<code>init_purchase</code>和<code>purchase</code>成功。</p>
<p>为了防止意外，我们再次执行查询余额的指令。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="再次查询余额"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423163641985?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>结果显示余额为<code>00000000</code>，返回<code>9000</code>。故而我们认为，查询消费圈存三大功能都已经能够正确执行了。</p>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="多次圈存两次冲入00001000&#43;消费测试一次消费00000001"
      
        class="image_figure image_external image_unprocessed"
        src="http://img.blog.csdn.net/20170423165827715?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTWljaGFlbDc1Mzk1MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast"
      
      
    />

    </picture>
</figure>
</p>
<p>最后测试一下<strong>多次存取操作</strong>。没什么问题，故而我们认为，本次实验成功。</p>
<p>2017/4/25更新</p>
<p>线下已校验多次存取（复杂数据），以及TAC码（我喜欢称其工单码）检验。经检验，不存在明显问题。</p>

    </div><div class="post_comments">
  
  
  
  
</div>




  </article>
<aside class="sidebar">
  <section class="sidebar_inner">
    <br>
    
  
  <div class="search">
    <input type="search" class="search_field form_field" placeholder='搜索内容...' id="find" autocomplete="off" data-scope='post'>
    <label for="find" class="search_label"><svg class="icon">
  <title>search</title>
  <use xlink:href="#search"></use>
</svg>

    </label>
    
    <div class="search_results results"></div>
  </div>

        <h2>Yunyao Long</h2>
      <div class="author_bio">
        Coding for everything
      </div>
      <a href='https://yaoyl.cn/about/' class="button mt-1" role="button" title='阅读更多'>阅读更多</a>

    
    <h2 class="mt-4">精选文章</h2>
    <ul>
      <li>
        <a href="https://yaoyl.cn//post/2025/%E5%9F%BA%E4%BA%8Econtinue%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B/" class="nav-link" title="M1芯片MacBook搭建本地大模型">M1芯片MacBook搭建本地大模型</a>
      </li>
      <li>
        <a href="https://yaoyl.cn//post/2025/%E6%90%AD%E5%BB%BA%E6%9C%AC%E5%9C%B0%E5%A4%A7%E6%A8%A1%E5%9E%8B/" class="nav-link" title="M1芯片MacBook搭建本地大模型">M1芯片MacBook搭建本地大模型</a>
      </li>
      <li>
        <a href="https://yaoyl.cn//post/2025/m1%E8%8A%AF%E7%89%87macbook%E5%AE%89%E8%A3%85docker/" class="nav-link" title="M1芯片MacBook安装Docker">M1芯片MacBook安装Docker</a>
      </li>
    </ul>
    <h2 class="mt-4">最新文章</h2>
    <ul class="flex-column">
      <li>
        <a href="https://yaoyl.cn//post/2025/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB-%E5%89%8D%E7%9E%BB/" class="nav-link" title="技术分享-前瞻">技术分享-前瞻</a>
      </li>
      <li>
        <a href="https://yaoyl.cn//post/%E5%8E%86%E5%8F%B2/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/" class="nav-link" title="设计模式-观察者模式">设计模式-观察者模式</a>
      </li>
      <li>
        <a href="https://yaoyl.cn//post/%E5%8E%86%E5%8F%B2/uml%E7%B1%BB%E5%9B%BE%E7%BB%98%E5%88%B6%E5%AE%9E%E4%BE%8B/" class="nav-link" title="UML类图绘制实例">UML类图绘制实例</a>
      </li>
      <li>
        <a href="https://yaoyl.cn//post/%E5%8E%86%E5%8F%B2/spring%E7%9A%84bean%E7%AE%A1%E7%90%86/" class="nav-link" title="Spring的Bean管理">Spring的Bean管理</a>
      </li>
      <li>
        <a href="https://yaoyl.cn//post/%E5%8E%86%E5%8F%B2/%E4%B8%80%E7%82%B9%E7%82%B9%E6%89%8B%E5%86%99spring/" class="nav-link" title="一点点手写Spring">一点点手写Spring</a>
      </li>
      <li>
        <a href="https://yaoyl.cn//post/%E5%8E%86%E5%8F%B2/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3%E5%B9%B6%E4%B8%94%E8%BF%9B%E8%A1%8C%E6%89%AB%E6%8F%8F%E8%A7%A3%E6%9E%90/" class="nav-link" title="自定义注解并且进行扫描解析">自定义注解并且进行扫描解析</a>
      </li>
      <li>
        <a href="https://yaoyl.cn//post/%E5%8E%86%E5%8F%B2/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3/" class="nav-link" title="Lambda表达式与函数式接口">Lambda表达式与函数式接口</a>
      </li>
      <li>
        <a href="https://yaoyl.cn//post/%E5%8E%86%E5%8F%B2/java%E7%9A%84integer%E7%B1%BB%E6%96%B9%E6%B3%95%E8%A7%A3%E8%AF%BB/" class="nav-link" title="Java的Integer类方法解读">Java的Integer类方法解读</a>
      </li>
    </ul>
    <div>
      <h2 class="mt-4 taxonomy" id="categories-section">分类</h2>
      <nav class="tags_nav">
        <a href='https://yaoyl.cn/categories/c&#43;&#43;/' class="post_tag button button_translucent" title="c&#43;&#43;">
          C&#43;&#43;
          <span class="button_tally">17</span>
        </a>
        
        <a href='https://yaoyl.cn/categories/java/' class="post_tag button button_translucent" title="java">
          JAVA
          <span class="button_tally">9</span>
        </a>
        
        <a href='https://yaoyl.cn/categories/%E9%9D%A2%E8%AF%95/' class="post_tag button button_translucent" title="面试">
          面试
          <span class="button_tally">5</span>
        </a>
        
        <a href='https://yaoyl.cn/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/' class="post_tag button button_translucent" title="技术分享">
          技术分享
          <span class="button_tally">4</span>
        </a>
        
        <a href='https://yaoyl.cn/categories/blog/' class="post_tag button button_translucent" title="blog">
          BLOG
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://yaoyl.cn/categories/python/' class="post_tag button button_translucent" title="python">
          PYTHON
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://yaoyl.cn/categories/%E6%9D%82%E8%B0%88/' class="post_tag button button_translucent" title="杂谈">
          杂谈
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://yaoyl.cn/categories/ubuntu/' class="post_tag button button_translucent" title="ubuntu">
          UBUNTU
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://yaoyl.cn/categories/%E6%9E%B6%E6%9E%84/' class="post_tag button button_translucent" title="架构">
          架构
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://yaoyl.cn/categories/%E8%BF%90%E7%BB%B4/' class="post_tag button button_translucent" title="运维">
          运维
          <span class="button_tally">1</span>
        </a>
        
        
      </nav>
    </div>
    <div>
      <h2 class="mt-4 taxonomy" id="series-section">专栏</h2>
      <nav class="tags_nav">
        <a href='https://yaoyl.cn/series/%E5%9F%BA%E7%A1%80%E6%90%AD%E5%BB%BA/' class="post_tag button button_translucent" title="基础搭建">
          基础搭建
          <span class="button_tally">3</span>
        </a>
        
        
      </nav>
    </div>
    <div>
      <h2 class="mt-4 taxonomy" id="tags-section">标签</h2>
      <nav class="tags_nav">
        <a href='https://yaoyl.cn/tags/c&#43;&#43;/' class="post_tag button button_translucent" title="c&#43;&#43;">
          C&#43;&#43;
          <span class="button_tally">16</span>
        </a>
        
        <a href='https://yaoyl.cn/tags/opengl/' class="post_tag button button_translucent" title="opengl">
          OPENGL
          <span class="button_tally">13</span>
        </a>
        
        <a href='https://yaoyl.cn/tags/java/' class="post_tag button button_translucent" title="java">
          JAVA
          <span class="button_tally">9</span>
        </a>
        
        <a href='https://yaoyl.cn/tags/nehe/' class="post_tag button button_translucent" title="nehe">
          NEHE
          <span class="button_tally">9</span>
        </a>
        
        <a href='https://yaoyl.cn/tags/ubuntu/' class="post_tag button button_translucent" title="ubuntu">
          UBUNTU
          <span class="button_tally">5</span>
        </a>
        
        <a href='https://yaoyl.cn/tags/%E9%9D%A2%E7%BB%8F/' class="post_tag button button_translucent" title="面经">
          面经
          <span class="button_tally">5</span>
        </a>
        
        <a href='https://yaoyl.cn/tags/%E8%99%9A%E6%8B%9F%E9%A9%BE%E9%A9%B6/' class="post_tag button button_translucent" title="虚拟驾驶">
          虚拟驾驶
          <span class="button_tally">4</span>
        </a>
        
        <a href='https://yaoyl.cn/tags/docker/' class="post_tag button button_translucent" title="docker">
          DOCKER
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://yaoyl.cn/tags/m1/' class="post_tag button button_translucent" title="m1">
          M1
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://yaoyl.cn/tags/macbook/' class="post_tag button button_translucent" title="macbook">
          MACBOOK
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://yaoyl.cn/tags/rfid/' class="post_tag button button_translucent" title="rfid">
          RFID
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://yaoyl.cn/tags/%E5%AE%B9%E5%99%A8/' class="post_tag button button_translucent" title="容器">
          容器
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://yaoyl.cn/tags/%E6%A0%A1%E6%8B%9B/' class="post_tag button button_translucent" title="校招">
          校招
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://yaoyl.cn/tags/%E7%BD%91%E6%98%93/' class="post_tag button button_translucent" title="网易">
          网易
          <span class="button_tally">3</span>
        </a>
        
        
        <br>
        <div class="post_tags_toggle button">所有标签</div>
        <div class="post_tags">
          <div class="tags_list">
            
            <a href='https://yaoyl.cn/tags/apache/' class=" post_tag button button_translucent" data-position=1 title="apache">APACHE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/bean%E7%AE%A1%E7%90%86/' class=" post_tag button button_translucent" data-position=1 title="bean管理">BEAN管理<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/blog/' class=" post_tag button button_translucent" data-position=2 title="blog">BLOG<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/c&#43;&#43;/' class=" post_tag button button_translucent" data-position=16 title="c&#43;&#43;">C&#43;&#43;<span class="button_tally">16</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/continue%E6%8F%92%E4%BB%B6/' class=" post_tag button button_translucent" data-position=1 title="continue插件">CONTINUE插件<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/csdn/' class=" post_tag button button_translucent" data-position=1 title="csdn">CSDN<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/c%E8%AF%AD%E8%A8%80/' class=" post_tag button button_translucent" data-position=2 title="c语言">C语言<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/docker/' class=" post_tag button button_translucent" data-position=3 title="docker">DOCKER<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/ghost/' class=" post_tag button button_translucent" data-position=2 title="ghost">GHOST<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/glgenlists/' class=" post_tag button button_translucent" data-position=1 title="glgenlists">GLGENLISTS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/glpolygonm/' class=" post_tag button button_translucent" data-position=1 title="glpolygonm">GLPOLYGONM<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/index/' class=" post_tag button button_translucent" data-position=1 title="index">INDEX<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/integer/' class=" post_tag button button_translucent" data-position=1 title="integer">INTEGER<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/java/' class=" post_tag button button_translucent" data-position=9 title="java">JAVA<span class="button_tally">9</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/' class=" post_tag button button_translucent" data-position=1 title="lambda表达式">LAMBDA表达式<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/llm/' class=" post_tag button button_translucent" data-position=1 title="llm">LLM<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/m1/' class=" post_tag button button_translucent" data-position=3 title="m1">M1<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/macbook/' class=" post_tag button button_translucent" data-position=3 title="macbook">MACBOOK<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/nehe/' class=" post_tag button button_translucent" data-position=9 title="nehe">NEHE<span class="button_tally">9</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/opengl/' class=" post_tag button button_translucent" data-position=13 title="opengl">OPENGL<span class="button_tally">13</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/python/' class=" post_tag button button_translucent" data-position=2 title="python">PYTHON<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/qwen/' class=" post_tag button button_translucent" data-position=1 title="qwen">QWEN<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/rfid/' class=" post_tag button button_translucent" data-position=3 title="rfid">RFID<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/socket/' class=" post_tag button button_translucent" data-position=2 title="socket">SOCKET<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/spring/' class=" post_tag button button_translucent" data-position=2 title="spring">SPRING<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/ubuntu/' class=" post_tag button button_translucent" data-position=5 title="ubuntu">UBUNTU<span class="button_tally">5</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/uml/' class=" post_tag button button_translucent" data-position=1 title="uml">UML<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/vs/' class=" post_tag button button_translucent" data-position=1 title="vs">VS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E5%8F%98%E6%8D%A2/' class=" post_tag button button_translucent" data-position=1 title="变换">变换<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/' class=" post_tag button button_translucent" data-position=1 title="多线程">多线程<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/' class=" post_tag button button_translucent" data-position=1 title="观察者模式">观察者模式<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3/' class=" post_tag button button_translucent" data-position=1 title="函数式接口">函数式接口<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E5%8D%8E%E4%B8%BA/' class=" post_tag button button_translucent" data-position=1 title="华为">华为<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E6%B7%B7%E5%90%88/' class=" post_tag button button_translucent" data-position=1 title="混合">混合<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E6%9E%B6%E6%9E%84/' class=" post_tag button button_translucent" data-position=1 title="架构">架构<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E5%BF%AB%E6%8D%B7%E9%94%AE/' class=" post_tag button button_translucent" data-position=1 title="快捷键">快捷键<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E6%97%85%E6%B8%B8/' class=" post_tag button button_translucent" data-position=1 title="旅游">旅游<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E9%9D%A2%E7%BB%8F/' class=" post_tag button button_translucent" data-position=5 title="面经">面经<span class="button_tally">5</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E7%88%AC%E8%99%AB/' class=" post_tag button button_translucent" data-position=2 title="爬虫">爬虫<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E9%A3%98%E5%8A%A8/' class=" post_tag button button_translucent" data-position=1 title="飘动">飘动<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E5%AE%B9%E5%99%A8/' class=" post_tag button button_translucent" data-position=3 title="容器">容器<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E8%AE%BE%E8%AE%A1/' class=" post_tag button button_translucent" data-position=1 title="设计">设计<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/' class=" post_tag button button_translucent" data-position=1 title="设计模式">设计模式<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E5%8F%8C%E7%B3%BB%E7%BB%9F/' class=" post_tag button button_translucent" data-position=1 title="双系统">双系统<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E9%9A%8F%E7%AC%94/' class=" post_tag button button_translucent" data-position=3 title="随笔">随笔<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E8%85%BE%E8%AE%AF/' class=" post_tag button button_translucent" data-position=1 title="腾讯">腾讯<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E5%9B%BE%E5%BA%8A/' class=" post_tag button button_translucent" data-position=1 title="图床">图床<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/' class=" post_tag button button_translucent" data-position=2 title="网络编程">网络编程<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E7%BD%91%E6%98%93/' class=" post_tag button button_translucent" data-position=3 title="网易">网易<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E6%96%87%E4%BB%B6%E8%BF%81%E7%A7%BB/' class=" post_tag button button_translucent" data-position=1 title="文件迁移">文件迁移<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E6%A0%A1%E6%8B%9B/' class=" post_tag button button_translucent" data-position=3 title="校招">校招<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E8%99%9A%E6%8B%9F%E9%A9%BE%E9%A9%B6/' class=" post_tag button button_translucent" data-position=4 title="虚拟驾驶">虚拟驾驶<span class="button_tally">4</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E5%BC%82%E6%AD%A5%E9%80%9A%E4%BF%A1/' class=" post_tag button button_translucent" data-position=1 title="异步通信">异步通信<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E6%BA%90%E4%BB%A3%E7%A0%81/' class=" post_tag button button_translucent" data-position=1 title="源代码">源代码<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E6%BA%90%E7%A0%81/' class=" post_tag button button_translucent" data-position=2 title="源码">源码<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E8%BF%90%E7%BB%B4/' class=" post_tag button button_translucent" data-position=1 title="运维">运维<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E6%9D%82%E8%B0%88/' class=" post_tag button button_translucent" data-position=2 title="杂谈">杂谈<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E6%B3%A8%E8%A7%A3/' class=" post_tag button button_translucent" data-position=1 title="注解">注解<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://yaoyl.cn/tags/%E6%B3%A8%E8%A7%A3%E6%89%AB%E6%8F%8F/' class=" post_tag button button_translucent" data-position=1 title="注解扫描">注解扫描<span class="button_tally">1</span>
            </a>
            
            <div class="tags_sort"><span title="sort alphabetically">[A~Z]</span><span title="sort by count">[0~9]</span>
            </div>
            <span class="tags_hide"><svg class="icon">
            <use xlink:href="#closeme"></use>
          </svg></span>
          </div>
        </div>
      </nav>
    </div>
  </section>
</aside>

  
</div>
    </main><svg width="0" height="0" class="hidden">
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter">
    <path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68 0 0 1-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043 0-1.924.366-2.643 1.078a3.56 3.56 0 0 0-1.076 2.605c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846 0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47 0 .929.273 1.705.82 2.388a3.623 3.623 0 0 0 2.115 1.291c-.312.08-.641.118-.979.118-.312 0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652 0 0 0 2.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422 0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139 0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77 0 0 0 1.172-4.892v-.468a7.788 7.788 0 0 0 1.84-1.921 8.142 8.142 0 0 1-2.11.593z"
      ></path>
  </symbol>
  <symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail">
    <path  d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar">
    <path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916 0 100v352c0 33.084 26.916 60 60 60h392c33.084 0 60-26.916 60-60V100c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028 0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028 0 20 8.972 20 20v48z"></path>
    <path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github">
    <path d="M255.968 5.329C114.624 5.329 0 120.401 0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384 0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008 0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992 0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584 0 34.368-.32 62.08-.32 70.496 0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab">
    <path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6 0L12.3 74.8z" />
    <path d="M12.3 74.7L.5 111c-1 3.2 0 6.8 3 8.8l101.6 74-92.5-119z"/>
    <path d="M105 193.7l-38.6-119h-54l92.7 119z"/>
    <path d="M105 193.7l38.7-119H66.4l38.7 119z"/>
    <path d="M105 193.7l38.7-119H198l-93 119z"/>
    <path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/>
    <path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6 0L198 74.8z"/>
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss">
    <circle cx="3.429" cy="20.571" r="3.429"></circle>
    <path d="M11.429 24h4.57C15.999 15.179 8.821 8.001 0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"></path>
    <path d="M24 24C24 10.766 13.234 0 0 0v4.571c10.714 0 19.43 8.714 19.43 19.429z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h362c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="to-top">
    <path d="M604.501 440.509L325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298 0 36.323s26.223 10.024 36.222 0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221 0 9.999-10.023 9.999-26.298 0-36.323z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly">
    <path d="M504.971 239.029L448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c19.851 0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002 0 0 0 400 320v108c0 19.851-16.149 36-36 36h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c46.318 0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568 0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255 0 24-10.745 24-24S205.255 0 192 0h-44c-46.318 0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568 0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255 0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851 0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002 0 0 0 112 192z"></path>
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy">
    <path d="M23 2.75A2.75 2.75 0 0 0 20.25 0H8.75A2.75 2.75 0 0 0 6 2.75v13.5A2.75 2.75 0 0 0 8.75 19h11.5A2.75 2.75 0 0 0 23 16.25zM18.25 14.5h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5z"></path>
    <path d="M8.75 20.5a4.255 4.255 0 0 1-4.25-4.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752 0 0 0 1 5.25v16A2.752 2.752 0 0 0 3.75 24h12a2.752 2.752 0 0 0 2.75-2.75v-.75z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme">
    <path d="M284.286 256.002L506.143 34.144c7.811-7.811 7.811-20.475 0-28.285-7.811-7.81-20.475-7.811-28.285 0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285 0-7.81 7.811-7.811 20.475 0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475 0 28.285a19.938 19.938 0 0 0 14.143 5.857 19.94 19.94 0 0 0 14.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475 0-28.285L284.286 256.002z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu">
    <path d="M492 236H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954 0 96s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram">
    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id=youtube>
    <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow">
    <path d="M21 27v-8h3v11H0V19h3v8h18z"></path><path d="M17.1.2L15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8l13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="xing">
    <path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 71 55" id="discord">
    <path d="M60.1045 4.8978C55.5792 2.8214 50.7265 1.2916 45.6527 0.41542C45.5603 0.39851 45.468 0.440769 45.4204 0.525289C44.7963 1.6353 44.105 3.0834 43.6209 4.2216C38.1637 3.4046 32.7345 3.4046 27.3892 4.2216C26.905 3.0581 26.1886 1.6353 25.5617 0.525289C25.5141 0.443589 25.4218 0.40133 25.3294 0.41542C20.2584 1.2888 15.4057 2.8186 10.8776 4.8978C10.8384 4.9147 10.8048 4.9429 10.7825 4.9795C1.57795 18.7309 -0.943561 32.1443 0.293408 45.3914C0.299005 45.4562 0.335386 45.5182 0.385761 45.5576C6.45866 50.0174 12.3413 52.7249 18.1147 54.5195C18.2071 54.5477 18.305 54.5139 18.3638 54.4378C19.7295 52.5728 20.9469 50.6063 21.9907 48.5383C22.0523 48.4172 21.9935 48.2735 21.8676 48.2256C19.9366 47.4931 18.0979 46.6 16.3292 45.5858C16.1893 45.5041 16.1781 45.304 16.3068 45.2082C16.679 44.9293 17.0513 44.6391 17.4067 44.3461C17.471 44.2926 17.5606 44.2813 17.6362 44.3151C29.2558 49.6202 41.8354 49.6202 53.3179 44.3151C53.3935 44.2785 53.4831 44.2898 53.5502 44.3433C53.9057 44.6363 54.2779 44.9293 54.6529 45.2082C54.7816 45.304 54.7732 45.5041 54.6333 45.5858C52.8646 46.6197 51.0259 47.4931 49.0921 48.2228C48.9662 48.2707 48.9102 48.4172 48.9718 48.5383C50.038 50.6034 51.2554 52.5699 52.5959 54.435C52.6519 54.5139 52.7526 54.5477 52.845 54.5195C58.6464 52.7249 64.529 50.0174 70.6019 45.5576C70.6551 45.5182 70.6887 45.459 70.6943 45.3942C72.1747 30.0791 68.2147 16.7757 60.1968 4.9823C60.1772 4.9429 60.1437 4.9147 60.1045 4.8978ZM23.7259 37.3253C20.2276 37.3253 17.3451 34.1136 17.3451 30.1693C17.3451 26.225 20.1717 23.0133 23.7259 23.0133C27.308 23.0133 30.1626 26.2532 30.1066 30.1693C30.1066 34.1136 27.28 37.3253 23.7259 37.3253ZM47.3178 37.3253C43.8196 37.3253 40.9371 34.1136 40.9371 30.1693C40.9371 26.225 43.7636 23.0133 47.3178 23.0133C50.9 23.0133 53.7545 26.2532 53.6986 30.1693C53.6986 34.1136 50.9 37.3253 47.3178 37.3253Z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 18" id="mastodon">
    <path
    fill="#ffffff"
    d="m 15.054695,9.8859583 c -0.22611,1.1632697 -2.02517,2.4363497 -4.09138,2.6830797 -1.0774504,0.12856 -2.1382704,0.24673 -3.2694704,0.19484 -1.84996,-0.0848 -3.30971,-0.44157 -3.30971,-0.44157 0,0.1801 0.0111,0.35157 0.0333,0.51194 0.24051,1.82571 1.81034,1.93508 3.29737,1.98607 1.50088,0.0514 2.8373104,-0.37004 2.8373104,-0.37004 l 0.0617,1.35686 c 0,0 -1.0498104,0.56374 -2.9199404,0.66742 -1.03124,0.0567 -2.3117,-0.0259 -3.80308,-0.42069 -3.23454998,-0.85613 -3.79081998,-4.304 -3.87592998,-7.8024197 -0.026,-1.03871 -0.01,-2.01815 -0.01,-2.83732 0,-3.57732 2.34385998,-4.62587996 2.34385998,-4.62587996 1.18184,-0.54277 3.20976,-0.77101 5.318,-0.7882499985409 h 0.0518 C 9.8267646,0.01719834 11.856025,0.24547834 13.037775,0.78824834 c 0,0 2.34377,1.04855996 2.34377,4.62587996 0,0 0.0294,2.63937 -0.32687,4.47183"/>
 <path
    fill="#000000"
    d="m 12.616925,5.6916583 v 4.3315297 h -1.71607 V 5.8189683 c 0,-0.88624 -0.37289,-1.33607 -1.1187604,-1.33607 -0.82467,0 -1.23799,0.53361 -1.23799,1.58875 v 2.30122 h -1.70594 v -2.30122 c 0,-1.05514 -0.4134,-1.58875 -1.23808,-1.58875 -0.74587,0 -1.11876,0.44983 -1.11876,1.33607 v 4.2042197 h -1.71607 V 5.6916583 c 0,-0.88527 0.22541,-1.58876 0.67817,-2.10922 0.46689,-0.52047 1.07833,-0.78727 1.83735,-0.78727 0.87816,0 1.54317,0.33752 1.98288,1.01267 l 0.42744,0.71655 0.42753,-0.71655 c 0.43961,-0.67515 1.10463,-1.01267 1.9828704,-1.01267 0.75893,0 1.37037,0.2668 1.83735,0.78727 0.45268,0.52046 0.67808,1.22395 0.67808,2.10922"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 530" id="bluesky" >
    <path d="m135.72 44.03c66.496 49.921 138.02 151.14 164.28 205.46 26.262-54.316 97.782-155.54 164.28-205.46 47.98-36.021 125.72-63.892 125.72 24.795 0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-0.0174-2.9357-1.1937 0.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07 0-88.687 77.742-60.816 125.72-24.795z"/>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" id="ko-fi">
    <path fill="#ffffff" d="M4.5,9.8527H32.7947a0,0,0,0,1,0,0v19.225a9.07,9.07,0,0,1-9.07,9.07H13.57a9.07,9.07,0,0,1-9.07-9.07V9.8527A0,0,0,0,1,4.5,9.8527Z"/>
    <path fill="#000000" d="M12.197,25.9493l6.45,6.45,6.45-6.45a8.2,8.2,0,0,0,2.4016-5.798h0a4.5082,4.5082,0,0,0-4.212-4.5459,4.4262,4.4262,0,0,0-4.64,4.4209,4.4261,4.4261,0,0,0-4.64-4.4209,4.5082,4.5082,0,0,0-4.212,4.5459h0A8.2,8.2,0,0,0,12.197,25.9493Z"/>
    <path fill="#ffffff" d="M32.7947,9.8527H35.73a7.77,7.77,0,0,1,0,15.5394H32.7947"/>
  </svg>
  </symbol>
</svg>

<footer class="footer">
  <div class="footer_inner wrap pale">
    <img src='https://yaoyl.cn/icons/apple-touch-icon.png' class="icon icon_2 transparent" alt="Copyright © 2017–2025, Yunyao Long and the Hugo Authors; 粤ICP备-17050867-1号">
    <p>Copyright&nbsp;<span class="year"></span>&nbsp;COPYRIGHT © 2017–2025, YUNYAO LONG AND THE HUGO AUTHORS; 粤ICP备-17050867-1号. All Rights Reserved</p><a class="to_top" href="#documentTop">
  <svg class="icon">
  <title>to-top</title>
  <use xlink:href="#to-top"></use>
</svg>

</a>

  </div>
</footer>

<script type="text/javascript" src="https://yaoyl.cn//zh/js/bundle.8f271a7a6d395b2060587165126e81bf1265bf8be2a25f4da029201983fd6a1ce76d15acb6cec02a048c2818f979766a191371aff44d01905ff33ee0875706d0.js" integrity="sha512-jycaem05WyBgWHFlEm6BvxJlv4viol9NoCkgGYP9ahznbRWsts7AKgSMKBj5eXZqGRNxr/RNAZBf8z7gh1cG0A==" crossorigin="anonymous"></script>

  <script src="https://yaoyl.cn//js/search.min.4c2b0421d128bbd7c43fc7d662fb5dfd8e439c60ee92c900a26d72d9c3271d2256f5bac9f6f919cddfd55101e9272898716cbb3381b4360bf43a66a5f7664f54.js"></script>

  </body>
</html>
